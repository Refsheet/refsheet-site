%h1 Cart
%table
  %tr
    %th ID
    %th Name
    %th Seller
    %th{width: 150}
    %th.right-align{width: 150} Amount

  - current_cart.line_items.each do |i|
    %tr
      %td{width: 100}= i.id
      %td
        = i.item.title
        - i.tap(&:valid?).errors.full_messages.each do |e|
          .red-text.text-darken-1= e
      %th= i.item.user.name

      %th.right-align
        = link_to 'Remove', marketplace_test_cart_path(id: i.id), class: 'red-text text-darken-2', method: :delete
      %td.right-align= i.item.amount.format

  %tr
    %td
    %td
    %td
    %th.right-align.larger Total
    %td.right-align.larger= current_cart.total.format

  - if current_cart.payable?
    %tr
      %td
      %td
      %td
      %td.right-align{colspan: 2}
        = simple_form_for Payment.new, url: marketplace_test_payment_path do |f|
          %script.stripe-button{ src: 'https://checkout.stripe.com/checkout.js',
                                 data: { amount: current_cart.total.cents,
                                         currency: current_cart.total.currency,
                                         description: current_cart.description,
                                         email: current_cart.email,
                                         key: Rails.configuration.x.stripe['publishable_key'] } }

  - elsif current_cart.invalid?
    - current_cart.errors.full_messages.each do |e|
      %tr
        %td
        %td
        %td.red-text.text-darkent-1.right-align{colspan: 3}= e
