!!!
%html
  %head
    :javascript
      window.Refsheet = {
        environment: "#{ j Rails.env }",
        version: "#{ j Refsheet::VERSION }",
        sentryDsn: "#{ j ENV['SENTRY_JS_DSN'] }",
        instance: {
          id: "#{ j ENV['EB_ENV_ID'] }",
          name: "#{ j ENV['EB_ENV_NAME'] }"
        }
      }

    -# Inline critical CSS styles
    %meta{name: 'viewport', content: 'width=device-width, initial-scale=1'}
    %meta{'http-equiv' => 'X-Clacks-Overhead', content: 'GNU Sir Terry Pratchett'}
    = render partial: 'critical_css'

    -# Site Metadata
    = display_meta_tags site: 'Refsheet.net'
    = csrf_meta_tags
    = render 'favicon'

    -# Defer JS Loading
    = javascript_pack_tag 'application', id: 'jsV2', defer: !Rails.env.test?, async: !Rails.env.test?
    = javascript_include_tag 'application', id: 'jsV1', defer: !Rails.env.test?, async: !Rails.env.test?

    -# Defer CSS Loading
    = stylesheet_pack_tag 'application', id: 'cssV2', rel: "preload", as: 'style', onload: "this.onload=null; this.rel='stylesheet'"
    = stylesheet_link_tag 'application', id: 'cssV1', rel: "preload", as: 'style', media: 'all', onload: "this.onload=null; this.rel='stylesheet'"
    %link{href: font_path('font-awesome/fa-brands-400.woff2'), rel: "preload", as: 'font', crossorigin: true, type: "font/woff2"}/
    %link{href: font_path('font-awesome/fa-solid-900.woff2'), rel: "preload", as: 'font', crossorigin: true, type: "font/woff2"}/
    %noscript
      = stylesheet_pack_tag 'application'
      = stylesheet_link_tag 'application', media: 'all'

    -# Other Stuff
    -#= javascript_include_tag 'https://js.stripe.com/v2/'


  %body{class: [yield(:body_class), params[:controller].gsub(/[^a-z]+/, ' ')].join(' ')}
    #rsVersion.version{style: 'display: none;'}= Refsheet::VERSION
    = render 'body'
